<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Matheus Jesus"><link href=https://c0d8.github.io/redes-neurais/MLP/main/ rel=canonical><link href=../../perceptron/main/ rel=prev><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.18"><title>MLP - Projeto Redes Neurais - Matheus Aguiar</title><link rel=stylesheet href=../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.1-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20168c-13.3%200-24%2010.7-24%2024v112c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24V192c0-13.3-10.7-24-24-24m26.7%20216a26.7%2026.7%200%201%200-53.3%200%2026.7%2026.7%200%201%200%2053.3%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20fill%3D%22currentColor%22%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../assets/_markdown_exec_ansi.css><link rel=stylesheet href=../../assets/stylesheets/badge.css><link rel=stylesheet href=../../termynal.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#exercise-1-manual-calculation-of-mlp-steps class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Projeto Redes Neurais - Matheus Aguiar" class="md-header__button md-logo" aria-label="Projeto Redes Neurais - Matheus Aguiar" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Projeto Redes Neurais - Matheus Aguiar </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> MLP </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/C0D8/redes-neurais title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/redes-neurais </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Projeto Redes Neurais - Matheus Aguiar" class="md-nav__button md-logo" aria-label="Projeto Redes Neurais - Matheus Aguiar" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> Projeto Redes Neurais - Matheus Aguiar </label> <div class=md-nav__source> <a href=https://github.com/C0D8/redes-neurais title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/redes-neurais </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Roteiros </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Roteiros </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../data/main/ class=md-nav__link> <span class=md-ellipsis> Data </span> </a> </li> <li class=md-nav__item> <a href=../../perceptron/main/ class=md-nav__link> <span class=md-ellipsis> Perceptron </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> MLP </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> MLP </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#exercise-1-manual-calculation-of-mlp-steps class=md-nav__link> <span class=md-ellipsis> Exercise 1: Manual Calculation of MLP Steps </span> </a> <nav class=md-nav aria-label="Exercise 1: Manual Calculation of MLP Steps"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#given-values class=md-nav__link> <span class=md-ellipsis> Given Values </span> </a> </li> <li class=md-nav__item> <a href=#step-1-forward-pass class=md-nav__link> <span class=md-ellipsis> Step 1: Forward Pass </span> </a> <nav class=md-nav aria-label="Step 1: Forward Pass"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-compute-hidden-layer-pre-activations class=md-nav__link> <span class=md-ellipsis> 1.1 Compute Hidden Layer Pre-Activations </span> </a> </li> <li class=md-nav__item> <a href=#12-apply-tanh-to-get-hidden-activations class=md-nav__link> <span class=md-ellipsis> 1.2 Apply Tanh to Get Hidden Activations </span> </a> </li> <li class=md-nav__item> <a href=#13-compute-output-pre-activation class=md-nav__link> <span class=md-ellipsis> 1.3 Compute Output Pre-Activation </span> </a> </li> <li class=md-nav__item> <a href=#14-compute-final-output class=md-nav__link> <span class=md-ellipsis> 1.4 Compute Final Output </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-2-loss-calculation class=md-nav__link> <span class=md-ellipsis> Step 2: Loss Calculation </span> </a> </li> <li class=md-nav__item> <a href=#step-3-backward-pass-backpropagation class=md-nav__link> <span class=md-ellipsis> Step 3: Backward Pass (Backpropagation) </span> </a> <nav class=md-nav aria-label="Step 3: Backward Pass (Backpropagation)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31-gradient-of-loss-wrt-output class=md-nav__link> <span class=md-ellipsis> 3.1 Gradient of Loss w.r.t. Output </span> </a> </li> <li class=md-nav__item> <a href=#32-gradient-wrt-output-pre-activation class=md-nav__link> <span class=md-ellipsis> 3.2 Gradient w.r.t. Output Pre-Activation </span> </a> </li> <li class=md-nav__item> <a href=#33-gradients-for-output-layer class=md-nav__link> <span class=md-ellipsis> 3.3 Gradients for Output Layer </span> </a> </li> <li class=md-nav__item> <a href=#34-propagate-to-hidden-layer class=md-nav__link> <span class=md-ellipsis> 3.4 Propagate to Hidden Layer </span> </a> </li> <li class=md-nav__item> <a href=#35-gradients-for-hidden-layer class=md-nav__link> <span class=md-ellipsis> 3.5 Gradients for Hidden Layer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-4-parameter-update class=md-nav__link> <span class=md-ellipsis> Step 4: Parameter Update </span> </a> <nav class=md-nav aria-label="Step 4: Parameter Update"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#output-layer-updates class=md-nav__link> <span class=md-ellipsis> Output Layer Updates </span> </a> </li> <li class=md-nav__item> <a href=#hidden-layer-updates class=md-nav__link> <span class=md-ellipsis> Hidden Layer Updates </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#summary-of-results class=md-nav__link> <span class=md-ellipsis> Summary of Results </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercise-2-binary-classification-with-synthetic-data-and-scratch-mlp class=md-nav__link> <span class=md-ellipsis> Exercise 2: Binary Classification with Synthetic Data and Scratch MLP </span> </a> <nav class=md-nav aria-label="Exercise 2: Binary Classification with Synthetic Data and Scratch MLP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-data-generation-and-splitting class=md-nav__link> <span class=md-ellipsis> Step 1: Data Generation and Splitting </span> </a> </li> <li class=md-nav__item> <a href=#step-2-mlp-implementation class=md-nav__link> <span class=md-ellipsis> Step 2: MLP Implementation </span> </a> </li> <li class=md-nav__item> <a href=#step-3-train-the-model class=md-nav__link> <span class=md-ellipsis> Step 3: Train the Model </span> </a> </li> <li class=md-nav__item> <a href=#step-4-evaluate-on-test-set class=md-nav__link> <span class=md-ellipsis> Step 4: Evaluate on Test Set </span> </a> </li> <li class=md-nav__item> <a href=#visualization-a-plot-showing-the-decision-boundary-separating-the-two-classes class=md-nav__link> <span class=md-ellipsis> Visualization: A plot showing the decision boundary separating the two classes. </span> </a> </li> <li class=md-nav__item> <a href=#explanation class=md-nav__link> <span class=md-ellipsis> Explanation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercise-3-multi-class-classification-with-synthetic-data-and-reusable-mlp class=md-nav__link> <span class=md-ellipsis> Exercise 3: Multi-Class Classification with Synthetic Data and Reusable MLP </span> </a> <nav class=md-nav aria-label="Exercise 3: Multi-Class Classification with Synthetic Data and Reusable MLP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-data-generation-and-splitting_1 class=md-nav__link> <span class=md-ellipsis> Step 1: Data Generation and Splitting </span> </a> </li> <li class=md-nav__item> <a href=#step-2-mlp-implementation_1 class=md-nav__link> <span class=md-ellipsis> Step 2: MLP Implementation </span> </a> </li> <li class=md-nav__item> <a href=#step-3-training class=md-nav__link> <span class=md-ellipsis> Step 3: Training </span> </a> </li> <li class=md-nav__item> <a href=#step-4-evaluation-and-visualization class=md-nav__link> <span class=md-ellipsis> Step 4: Evaluation and Visualization </span> </a> </li> <li class=md-nav__item> <a href=#code-implementation class=md-nav__link> <span class=md-ellipsis> Code Implementation </span> </a> </li> <li class=md-nav__item> <a href=#explanation-of-changes-from-exercise-2 class=md-nav__link> <span class=md-ellipsis> Explanation of Changes from Exercise 2 </span> </a> </li> <li class=md-nav__item> <a href=#sample-output class=md-nav__link> <span class=md-ellipsis> Sample Output </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercise-4-multi-class-classification-with-deeper-mlp class=md-nav__link> <span class=md-ellipsis> Exercise 4: Multi-Class Classification with Deeper MLP </span> </a> <nav class=md-nav aria-label="Exercise 4: Multi-Class Classification with Deeper MLP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#objective class=md-nav__link> <span class=md-ellipsis> Objective </span> </a> </li> <li class=md-nav__item> <a href=#step-1-data-generation class=md-nav__link> <span class=md-ellipsis> Step 1: Data Generation </span> </a> </li> <li class=md-nav__item> <a href=#step-2-mlp-implementation_2 class=md-nav__link> <span class=md-ellipsis> Step 2: MLP Implementation </span> </a> </li> <li class=md-nav__item> <a href=#step-3-training-and-evaluation class=md-nav__link> <span class=md-ellipsis> Step 3: Training and Evaluation </span> </a> </li> <li class=md-nav__item> <a href=#code-implementation_1 class=md-nav__link> <span class=md-ellipsis> Code Implementation </span> </a> </li> <li class=md-nav__item> <a href=#explanation-of-changes-from-exercise-3 class=md-nav__link> <span class=md-ellipsis> Explanation of Changes from Exercise 3 </span> </a> </li> <li class=md-nav__item> <a href=#sample-output_1 class=md-nav__link> <span class=md-ellipsis> Sample Output </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#exercise-1-manual-calculation-of-mlp-steps class=md-nav__link> <span class=md-ellipsis> Exercise 1: Manual Calculation of MLP Steps </span> </a> <nav class=md-nav aria-label="Exercise 1: Manual Calculation of MLP Steps"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#given-values class=md-nav__link> <span class=md-ellipsis> Given Values </span> </a> </li> <li class=md-nav__item> <a href=#step-1-forward-pass class=md-nav__link> <span class=md-ellipsis> Step 1: Forward Pass </span> </a> <nav class=md-nav aria-label="Step 1: Forward Pass"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-compute-hidden-layer-pre-activations class=md-nav__link> <span class=md-ellipsis> 1.1 Compute Hidden Layer Pre-Activations </span> </a> </li> <li class=md-nav__item> <a href=#12-apply-tanh-to-get-hidden-activations class=md-nav__link> <span class=md-ellipsis> 1.2 Apply Tanh to Get Hidden Activations </span> </a> </li> <li class=md-nav__item> <a href=#13-compute-output-pre-activation class=md-nav__link> <span class=md-ellipsis> 1.3 Compute Output Pre-Activation </span> </a> </li> <li class=md-nav__item> <a href=#14-compute-final-output class=md-nav__link> <span class=md-ellipsis> 1.4 Compute Final Output </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-2-loss-calculation class=md-nav__link> <span class=md-ellipsis> Step 2: Loss Calculation </span> </a> </li> <li class=md-nav__item> <a href=#step-3-backward-pass-backpropagation class=md-nav__link> <span class=md-ellipsis> Step 3: Backward Pass (Backpropagation) </span> </a> <nav class=md-nav aria-label="Step 3: Backward Pass (Backpropagation)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#31-gradient-of-loss-wrt-output class=md-nav__link> <span class=md-ellipsis> 3.1 Gradient of Loss w.r.t. Output </span> </a> </li> <li class=md-nav__item> <a href=#32-gradient-wrt-output-pre-activation class=md-nav__link> <span class=md-ellipsis> 3.2 Gradient w.r.t. Output Pre-Activation </span> </a> </li> <li class=md-nav__item> <a href=#33-gradients-for-output-layer class=md-nav__link> <span class=md-ellipsis> 3.3 Gradients for Output Layer </span> </a> </li> <li class=md-nav__item> <a href=#34-propagate-to-hidden-layer class=md-nav__link> <span class=md-ellipsis> 3.4 Propagate to Hidden Layer </span> </a> </li> <li class=md-nav__item> <a href=#35-gradients-for-hidden-layer class=md-nav__link> <span class=md-ellipsis> 3.5 Gradients for Hidden Layer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-4-parameter-update class=md-nav__link> <span class=md-ellipsis> Step 4: Parameter Update </span> </a> <nav class=md-nav aria-label="Step 4: Parameter Update"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#output-layer-updates class=md-nav__link> <span class=md-ellipsis> Output Layer Updates </span> </a> </li> <li class=md-nav__item> <a href=#hidden-layer-updates class=md-nav__link> <span class=md-ellipsis> Hidden Layer Updates </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#summary-of-results class=md-nav__link> <span class=md-ellipsis> Summary of Results </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercise-2-binary-classification-with-synthetic-data-and-scratch-mlp class=md-nav__link> <span class=md-ellipsis> Exercise 2: Binary Classification with Synthetic Data and Scratch MLP </span> </a> <nav class=md-nav aria-label="Exercise 2: Binary Classification with Synthetic Data and Scratch MLP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-data-generation-and-splitting class=md-nav__link> <span class=md-ellipsis> Step 1: Data Generation and Splitting </span> </a> </li> <li class=md-nav__item> <a href=#step-2-mlp-implementation class=md-nav__link> <span class=md-ellipsis> Step 2: MLP Implementation </span> </a> </li> <li class=md-nav__item> <a href=#step-3-train-the-model class=md-nav__link> <span class=md-ellipsis> Step 3: Train the Model </span> </a> </li> <li class=md-nav__item> <a href=#step-4-evaluate-on-test-set class=md-nav__link> <span class=md-ellipsis> Step 4: Evaluate on Test Set </span> </a> </li> <li class=md-nav__item> <a href=#visualization-a-plot-showing-the-decision-boundary-separating-the-two-classes class=md-nav__link> <span class=md-ellipsis> Visualization: A plot showing the decision boundary separating the two classes. </span> </a> </li> <li class=md-nav__item> <a href=#explanation class=md-nav__link> <span class=md-ellipsis> Explanation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercise-3-multi-class-classification-with-synthetic-data-and-reusable-mlp class=md-nav__link> <span class=md-ellipsis> Exercise 3: Multi-Class Classification with Synthetic Data and Reusable MLP </span> </a> <nav class=md-nav aria-label="Exercise 3: Multi-Class Classification with Synthetic Data and Reusable MLP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-data-generation-and-splitting_1 class=md-nav__link> <span class=md-ellipsis> Step 1: Data Generation and Splitting </span> </a> </li> <li class=md-nav__item> <a href=#step-2-mlp-implementation_1 class=md-nav__link> <span class=md-ellipsis> Step 2: MLP Implementation </span> </a> </li> <li class=md-nav__item> <a href=#step-3-training class=md-nav__link> <span class=md-ellipsis> Step 3: Training </span> </a> </li> <li class=md-nav__item> <a href=#step-4-evaluation-and-visualization class=md-nav__link> <span class=md-ellipsis> Step 4: Evaluation and Visualization </span> </a> </li> <li class=md-nav__item> <a href=#code-implementation class=md-nav__link> <span class=md-ellipsis> Code Implementation </span> </a> </li> <li class=md-nav__item> <a href=#explanation-of-changes-from-exercise-2 class=md-nav__link> <span class=md-ellipsis> Explanation of Changes from Exercise 2 </span> </a> </li> <li class=md-nav__item> <a href=#sample-output class=md-nav__link> <span class=md-ellipsis> Sample Output </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercise-4-multi-class-classification-with-deeper-mlp class=md-nav__link> <span class=md-ellipsis> Exercise 4: Multi-Class Classification with Deeper MLP </span> </a> <nav class=md-nav aria-label="Exercise 4: Multi-Class Classification with Deeper MLP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#objective class=md-nav__link> <span class=md-ellipsis> Objective </span> </a> </li> <li class=md-nav__item> <a href=#step-1-data-generation class=md-nav__link> <span class=md-ellipsis> Step 1: Data Generation </span> </a> </li> <li class=md-nav__item> <a href=#step-2-mlp-implementation_2 class=md-nav__link> <span class=md-ellipsis> Step 2: MLP Implementation </span> </a> </li> <li class=md-nav__item> <a href=#step-3-training-and-evaluation class=md-nav__link> <span class=md-ellipsis> Step 3: Training and Evaluation </span> </a> </li> <li class=md-nav__item> <a href=#code-implementation_1 class=md-nav__link> <span class=md-ellipsis> Code Implementation </span> </a> </li> <li class=md-nav__item> <a href=#explanation-of-changes-from-exercise-3 class=md-nav__link> <span class=md-ellipsis> Explanation of Changes from Exercise 3 </span> </a> </li> <li class=md-nav__item> <a href=#sample-output_1 class=md-nav__link> <span class=md-ellipsis> Sample Output </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>MLP</h1> <h2 id=exercise-1-manual-calculation-of-mlp-steps><strong>Exercise 1: Manual Calculation of MLP Steps</strong></h2> <h3 id=given-values><strong>Given Values</strong></h3> <ul> <li>Input: $ \mathbf{x} = [0.5, -0.2] $</li> <li>Target output: $ y = 1.0 $</li> <li>Hidden layer weights: $ \mathbf{W}^{(1)} = \begin{bmatrix} 0.3 &amp; -0.1 \ 0.2 &amp; 0.4 \end{bmatrix} $</li> <li>Hidden layer biases: $ \mathbf{b}^{(1)} = [0.1, -0.2] $</li> <li>Output layer weights: $ \mathbf{W}^{(2)} = [0.5, -0.3] $</li> <li>Output layer bias: $ b^{(2)} = 0.2 $</li> <li>Learning rate: $ \eta = 0.3 $ (Note: The problem statement mentions $ \eta = 0.1 $ in the parameter update section, which seems inconsistent. I’ll use $ \eta = 0.3 $ as specified earlier, but I’ll note the discrepancy and proceed. If needed, I can recompute with $ \eta = 0.1 $.)</li> <li>Activation function: $ \tanh(u) $</li> <li>Loss function: $ L = \frac{1}{N} (y - \hat{y})^2 $, with $ N = 1 $ (single sample)</li> </ul> <hr> <h3 id=step-1-forward-pass><strong>Step 1: Forward Pass</strong></h3> <h4 id=11-compute-hidden-layer-pre-activations><strong>1.1 Compute Hidden Layer Pre-Activations</strong></h4> <div class=arithmatex>\[ \mathbf{z}^{(1)} = \mathbf{W}^{(1)} \mathbf{x} + \mathbf{b}^{(1)} \]</div> <ul> <li> <p>$ \mathbf{W}^{(1)} = \begin{bmatrix} 0.3 &amp; -0.1 \ 0.2 &amp; 0.4 \end{bmatrix}, \quad \mathbf{x} = \begin{bmatrix} 0.5 \ -0.2 \end{bmatrix}, \quad \mathbf{b}^{(1)} = \begin{bmatrix} 0.1 \ -0.2 \end{bmatrix} $</p> </li> <li> <p>Matrix multiplication:<br> $ \mathbf{W}^{(1)} \mathbf{x} = \begin{bmatrix} 0.3 \cdot 0.5 + (-0.1) \cdot (-0.2) \ 0.2 \cdot 0.5 + 0.4 \cdot (-0.2) \end{bmatrix} $</p> </li> <li> <p>First element: $ 0.3 \cdot 0.5 = 0.15 $, $ -0.1 \cdot (-0.2) = 0.02 $, so $ 0.15 + 0.02 = 0.17 $</p> </li> <li> <p>Second element: $ 0.2 \cdot 0.5 = 0.1 $, $ 0.4 \cdot (-0.2) = -0.08 $, so $ 0.1 - 0.08 = 0.02 $</p> </li> <li> <p>$ \mathbf{W}^{(1)} \mathbf{x} = \begin{bmatrix} 0.17 \ 0.02 \end{bmatrix} $</p> </li> <li> <p>Add biases:<br> $ \mathbf{z}^{(1)} = \begin{bmatrix} 0.17 \ 0.02 \end{bmatrix} + \begin{bmatrix} 0.1 \ -0.2 \end{bmatrix} = \begin{bmatrix} 0.27 \ -0.18 \end{bmatrix} $</p> </li> </ul> <div class=arithmatex>\[ \mathbf{z}^{(1)} = \begin{bmatrix} 0.27 \\ -0.18 \end{bmatrix} \]</div> <hr> <h4 id=12-apply-tanh-to-get-hidden-activations><strong>1.2 Apply Tanh to Get Hidden Activations</strong></h4> <div class=arithmatex>\[ \mathbf{h}^{(1)} = \tanh(\mathbf{z}^{(1)}) = \begin{bmatrix} \tanh(0.27) \\ \tanh(-0.18) \end{bmatrix} \]</div> <ul> <li>Compute $ \tanh(0.27) \approx 0.2636 $</li> <li>Compute $ \tanh(-0.18) \approx -0.1781 $</li> </ul> <div class=arithmatex>\[ \mathbf{h}^{(1)} = \begin{bmatrix} 0.2636 \\ -0.1781 \end{bmatrix} \]</div> <hr> <h4 id=13-compute-output-pre-activation><strong>1.3 Compute Output Pre-Activation</strong></h4> <div class=arithmatex>\[ u^{(2)} = \mathbf{W}^{(2)} \mathbf{h}^{(1)} + b^{(2)} \]</div> <ul> <li> <p>$ \mathbf{W}^{(2)} = [0.5, -0.3], \quad \mathbf{h}^{(1)} = \begin{bmatrix} 0.2636 \ -0.1781 \end{bmatrix}, \quad b^{(2)} = 0.2 $</p> </li> <li> <p>Dot product:<br> $ \mathbf{W}^{(2)} \mathbf{h}^{(1)} = 0.5 \cdot 0.2636 + (-0.3) \cdot (-0.1781) \approx 0.1318 + 0.0534 = 0.1852 $</p> </li> <li> <p>Add bias: $ u^{(2)} = 0.1852 + 0.2 = 0.3852 $</p> </li> </ul> <div class=arithmatex>\[ u^{(2)} \approx 0.3852 \]</div> <hr> <h4 id=14-compute-final-output><strong>1.4 Compute Final Output</strong></h4> <div class=arithmatex>\[ \hat{y} = \tanh(u^{(2)}) = \tanh(0.3852) \approx 0.3672 \]</div> <hr> <h3 id=step-2-loss-calculation><strong>Step 2: Loss Calculation</strong></h3> <div class=arithmatex>\[ L = \frac{1}{N} (y - \hat{y})^2, \quad N = 1 \]</div> <ul> <li>$ y = 1.0, \quad \hat{y} \approx 0.3672 $</li> <li>$ y - \hat{y} = 0.6328 $</li> <li>$ L = (0.6328)^2 \approx 0.4004 $</li> </ul> <div class=arithmatex>\[ L \approx 0.4004 \]</div> <hr> <h3 id=step-3-backward-pass-backpropagation><strong>Step 3: Backward Pass (Backpropagation)</strong></h3> <h4 id=31-gradient-of-loss-wrt-output><strong>3.1 Gradient of Loss w.r.t. Output</strong></h4> <div class=arithmatex>\[ \frac{\partial L}{\partial \hat{y}} = -2 (y - \hat{y}) \]</div> <ul> <li>$ \frac{\partial L}{\partial \hat{y}} \approx -2 \cdot 0.6328 = -1.2656 $</li> </ul> <hr> <h4 id=32-gradient-wrt-output-pre-activation><strong>3.2 Gradient w.r.t. Output Pre-Activation</strong></h4> <div class=arithmatex>\[ \frac{\partial L}{\partial u^{(2)}} = \frac{\partial L}{\partial \hat{y}} \cdot (1 - \hat{y}^2) \]</div> <ul> <li>$ 1 - \hat{y}^2 \approx 1 - (0.3672)^2 = 0.8652 $</li> <li>$ \frac{\partial L}{\partial u^{(2)}} \approx -1.2656 \cdot 0.8652 = -1.0953 $</li> </ul> <hr> <h4 id=33-gradients-for-output-layer><strong>3.3 Gradients for Output Layer</strong></h4> <ul> <li> <p><strong>Weight gradients</strong>: $$ \frac{\partial L}{\partial \mathbf{W}^{(2)}} = \frac{\partial L}{\partial u^{(2)}} \cdot \mathbf{h}^{(1)} $$</p> </li> <li> <p>$ [-1.0953] \cdot [0.2636, -0.1781] \approx [-0.2887, 0.1950] $</p> </li> </ul> <div class=arithmatex>\[ \frac{\partial L}{\partial \mathbf{W}^{(2)}} \approx [-0.2887, 0.1950] \]</div> <ul> <li><strong>Bias gradient</strong>: $$ \frac{\partial L}{\partial b^{(2)}} = \frac{\partial L}{\partial u^{(2)}} \approx -1.0953 $$</li> </ul> <hr> <h4 id=34-propagate-to-hidden-layer><strong>3.4 Propagate to Hidden Layer</strong></h4> <ul> <li> <p><strong>Gradient w.r.t. hidden activations</strong>: $$ \frac{\partial L}{\partial \mathbf{h}^{(1)}} = \frac{\partial L}{\partial u^{(2)}} \cdot \mathbf{W}^{(2)} $$</p> </li> <li> <p>$ [-1.0953] \cdot [0.5, -0.3] \approx [-0.5476, 0.3286] $</p> </li> </ul> <div class=arithmatex>\[ \frac{\partial L}{\partial \mathbf{h}^{(1)}} \approx [-0.5476, 0.3286] \]</div> <ul> <li> <p><strong>Gradient w.r.t. hidden pre-activations</strong>: $$ \frac{\partial L}{\partial \mathbf{z}^{(1)}} = \frac{\partial L}{\partial \mathbf{h}^{(1)}} \odot (1 - (\mathbf{h}<sup>{(1)})</sup>2) $$</p> </li> <li> <p>For $ h^{(1)}_1 = 0.2636: 1 - (0.2636)^2 \approx 0.9306 $ </p> </li> <li> <p>For $ h^{(1)}_2 = -0.1781: 1 - (0.1781)^2 \approx 0.9683 $</p> </li> <li> <p>Elementwise product: $ [-0.5476 \cdot 0.9306, \, 0.3286 \cdot 0.9683] \approx [-0.5096, 0.3181] $</p> </li> </ul> <div class=arithmatex>\[ \frac{\partial L}{\partial \mathbf{z}^{(1)}} \approx [-0.5096, 0.3181] \]</div> <hr> <h4 id=35-gradients-for-hidden-layer><strong>3.5 Gradients for Hidden Layer</strong></h4> <ul> <li> <p><strong>Weight gradients</strong>: $$ \frac{\partial L}{\partial \mathbf{W}^{(1)}} = \frac{\partial L}{\partial \mathbf{z}^{(1)}} \cdot \mathbf{x}^T $$</p> </li> <li> <p>$ \mathbf{x} = [0.5, -0.2] $</p> </li> <li>$ [-0.5096, 0.3181]^T \cdot [0.5, -0.2] = \begin{bmatrix} -0.2548 &amp; 0.1019 \ 0.1590 &amp; -0.0636 \end{bmatrix} $</li> </ul> <div class=arithmatex>\[ \frac{\partial L}{\partial \mathbf{W}^{(1)}} \approx \begin{bmatrix} -0.2548 &amp; 0.1019 \\ 0.1590 &amp; -0.0636 \end{bmatrix} \]</div> <ul> <li><strong>Bias gradients</strong>: $$ \frac{\partial L}{\partial \mathbf{b}^{(1)}} = \frac{\partial L}{\partial \mathbf{z}^{(1)}} \approx [-0.5096, 0.3181] $$</li> </ul> <hr> <h3 id=step-4-parameter-update><strong>Step 4: Parameter Update</strong></h3> <p>Using gradient descent with $ \eta = 0.3 $:</p> <div class=arithmatex>\[ \mathbf{W} \leftarrow \mathbf{W} - \eta \frac{\partial L}{\partial \mathbf{W}}, \quad b \leftarrow b - \eta \frac{\partial L}{\partial b} \]</div> <h4 id=output-layer-updates><strong>Output Layer Updates</strong></h4> <ul> <li> <p><strong>Weights</strong>: $$ \mathbf{W}^{(2)} = [0.5, -0.3] - 0.3 \cdot [-0.2887, 0.1950] \approx [0.5866, -0.3585] $$</p> </li> <li> <p><strong>Bias</strong>: $$ b^{(2)} = 0.2 - 0.3 \cdot (-1.0953) \approx 0.5286 $$</p> </li> </ul> <hr> <h4 id=hidden-layer-updates><strong>Hidden Layer Updates</strong></h4> <ul> <li><strong>Weights</strong>: $$ \mathbf{W}^{(1)} = \begin{bmatrix} 0.3 &amp; -0.1 \ 0.2 &amp; 0.4 \end{bmatrix} </li> <li>0.3 \cdot \begin{bmatrix} -0.2548 &amp; 0.1019 \ 0.1590 &amp; -0.0636 \end{bmatrix} $$</li> </ul> <div class=arithmatex>\[ \mathbf{W}^{(1)} \approx \begin{bmatrix} 0.3764 &amp; -0.1306 \\ 0.1523 &amp; 0.4191 \end{bmatrix} \]</div> <ul> <li><strong>Biases</strong>: $$ \mathbf{b}^{(1)} = [0.1, -0.2] - 0.3 \cdot [-0.5096, 0.3181] \approx [0.253, -0.295] $$</li> </ul> <hr> <h3 id=summary-of-results><strong>Summary of Results</strong></h3> <ul> <li><strong>Forward Pass</strong>:</li> <li>$ \mathbf{z}^{(1)} \approx [0.27, -0.18] $</li> <li>$ \mathbf{h}^{(1)} \approx [0.2636, -0.1781] $</li> <li>$ u^{(2)} \approx 0.3852 $</li> <li>$ \hat{y} \approx 0.3672 $</li> <li><strong>Loss</strong>: $ L \approx 0.4004 $</li> <li><strong>Gradients</strong>:</li> <li>$ \frac{\partial L}{\partial \mathbf{W}^{(2)}} \approx [-0.2887, 0.1950] $</li> <li>$ \frac{\partial L}{\partial b^{(2)}} \approx -1.0953 $</li> <li>$ \frac{\partial L}{\partial \mathbf{W}^{(1)}} \approx \begin{bmatrix} -0.2548 &amp; 0.1019 \ 0.1590 &amp; -0.0636 \end{bmatrix} $</li> <li>$ \frac{\partial L}{\partial \mathbf{b}^{(1)}} \approx [-0.5096, 0.3181] $</li> <li><strong>Updated Parameters</strong>:</li> <li>$ \mathbf{W}^{(2)} \approx [0.5866, -0.3585] $</li> <li>$ b^{(2)} \approx 0.5286 $</li> <li>$ \mathbf{W}^{(1)} \approx \begin{bmatrix} 0.3764 &amp; -0.1306 \ 0.1523 &amp; 0.4191 \end{bmatrix} $</li> <li>$ \mathbf{b}^{(1)} \approx [0.253, -0.295] $</li> </ul> <p><strong>Note</strong>: </p> <p>If $ \eta = 0.1 $ is required for updates (due to the discrepancy in the problem), please confirm, and I can recompute the parameter updates.</p> <hr> <h2 id=exercise-2-binary-classification-with-synthetic-data-and-scratch-mlp><strong>Exercise 2: Binary Classification with Synthetic Data and Scratch MLP</strong></h2> <p>We’ll generate a synthetic dataset using <code>make_classification</code> from scikit-learn, implement an MLP from scratch using NumPy for matrix operations, and train it for binary classification. The implementation will include forward pass, loss computation, backward pass, and parameter updates, followed by evaluation and visualization.</p> <h3 id=step-1-data-generation-and-splitting><strong>Step 1: Data Generation and Splitting</strong></h3> <p>We need: - 1000 samples, 2 classes, 2 features, 2 informative features, 0 redundant features. - 1 cluster for one class, 2 clusters for the other. - Split: 80% train (800 samples), 20% test (200 samples). - <code>random_state=42</code> for reproducibility.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># Data generation for Exercise 2</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=n>X0</span><span class=p>,</span> <span class=n>y0</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>                            <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=n>y0</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>  <span class=c1># Class 0 with 1 cluster</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=n>X1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>                            <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>43</span><span class=p>,</span> <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=n>y1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>  <span class=c1># Class 1 with 2 clusters</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>((</span><span class=n>X0</span><span class=p>,</span> <span class=n>X1</span><span class=p>))</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>y0</span><span class=p>,</span> <span class=n>y1</span><span class=p>))</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=c1># Standardize data</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=n>X</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>)</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=n>y_train</span> <span class=o>=</span> <span class=n>y_train</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>  <span class=c1># Reshape for binary classification</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=n>y_test</span> <span class=o>=</span> <span class=n>y_test</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></code></pre></div> <h3 id=step-2-mlp-implementation><strong>Step 2: MLP Implementation</strong></h3> <p><strong>Architecture</strong>: - Input layer: 2 features - Hidden layer: 64 neurons, ReLU activation $ \text{ReLU}(x) = \max(0, x)$ - Output layer: 1 neuron, sigmoid activation $ \sigma(z) = \frac{1}{1 + e^{-z}} $ - Loss: Binary cross-entropy $[ L = -\frac{1}{N} \sum_{i=1}^N \left[ y_i \log(\hat{y}_i) + (1 - y_i) \log(1 - \hat{y}_i) \right] $ - Optimizer: Gradient descent, learning rate $ \eta = 0.1 $ - Epochs: 200</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=k>class</span><span class=w> </span><span class=nc>MLP</span><span class=p>:</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_size</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>hidden_size</span><span class=o>=</span><span class=mi>64</span><span class=p>,</span> <span class=n>output_size</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.1</span><span class=p>):</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>        <span class=c1># He initialization</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>/</span> <span class=n>input_size</span><span class=p>)</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>))</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>hidden_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>/</span> <span class=n>hidden_size</span><span class=p>)</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>output_size</span><span class=p>))</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>=</span> <span class=n>lr</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>relu</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>    <span class=k>def</span><span class=w> </span><span class=nf>relu_derivative</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>    <span class=k>def</span><span class=w> </span><span class=nf>sigmoid</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>        <span class=k>return</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=o>-</span><span class=mi>500</span><span class=p>,</span> <span class=mi>500</span><span class=p>)))</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>    <span class=k>def</span><span class=w> </span><span class=nf>softmax</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>        <span class=n>exp_x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>        <span class=k>return</span> <span class=n>exp_x</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>exp_x</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>    <span class=k>def</span><span class=w> </span><span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a>        <span class=c1># Hidden layer</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>        <span class=bp>self</span><span class=o>.</span><span class=n>z1</span> <span class=o>=</span> <span class=n>X</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W1</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b1</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>        <span class=bp>self</span><span class=o>.</span><span class=n>h1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z1</span><span class=p>)</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>        <span class=c1># Output layer</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>        <span class=bp>self</span><span class=o>.</span><span class=n>z2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>h1</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W2</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b2</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a>        <span class=k>if</span> <span class=n>is_binary</span><span class=p>:</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a>            <span class=bp>self</span><span class=o>.</span><span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>sigmoid</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z2</span><span class=p>)</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a>            <span class=bp>self</span><span class=o>.</span><span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z2</span><span class=p>)</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>y_hat</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute_loss</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a>        <span class=n>y_hat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>y_hat</span><span class=p>,</span> <span class=mf>1e-15</span><span class=p>,</span> <span class=mi>1</span> <span class=o>-</span> <span class=mf>1e-15</span><span class=p>)</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a>        <span class=k>if</span> <span class=n>is_binary</span><span class=p>:</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>            <span class=k>return</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>y</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>y_hat</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>y_hat</span><span class=p>))</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a>            <span class=k>return</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>y</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>y_hat</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a>    <span class=k>def</span><span class=w> </span><span class=nf>backward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a>        <span class=n>N</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a>        <span class=k>if</span> <span class=n>is_binary</span><span class=p>:</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a>            <span class=n>dL_dz2</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_hat</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span> <span class=o>/</span> <span class=n>N</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a>            <span class=n>dL_dz2</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_hat</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span> <span class=o>/</span> <span class=n>N</span>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a>        <span class=n>dL_dW2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>h1</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>dL_dz2</span>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a>        <span class=n>dL_db2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dL_dz2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a>        <span class=n>dL_dh1</span> <span class=o>=</span> <span class=n>dL_dz2</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W2</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a>        <span class=n>dL_dz1</span> <span class=o>=</span> <span class=n>dL_dh1</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu_derivative</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z1</span><span class=p>)</span>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a>        <span class=n>dL_dW1</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>dL_dz1</span>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a>        <span class=n>dL_db1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dL_dz1</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a>        <span class=c1># Gradient clipping</span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a>        <span class=n>max_grad</span> <span class=o>=</span> <span class=mf>1.0</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a>        <span class=n>dL_dW1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>dL_dW1</span><span class=p>,</span> <span class=o>-</span><span class=n>max_grad</span><span class=p>,</span> <span class=n>max_grad</span><span class=p>)</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57 href=#__codelineno-1-57></a>        <span class=n>dL_dW2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>dL_dW2</span><span class=p>,</span> <span class=o>-</span><span class=n>max_grad</span><span class=p>,</span> <span class=n>max_grad</span><span class=p>)</span>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58 href=#__codelineno-1-58></a>        <span class=c1># Update parameters</span>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59 href=#__codelineno-1-59></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W2</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_dW2</span>
</span><span id=__span-1-60><a id=__codelineno-1-60 name=__codelineno-1-60 href=#__codelineno-1-60></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b2</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_db2</span>
</span><span id=__span-1-61><a id=__codelineno-1-61 name=__codelineno-1-61 href=#__codelineno-1-61></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W1</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_dW1</span>
</span><span id=__span-1-62><a id=__codelineno-1-62 name=__codelineno-1-62 href=#__codelineno-1-62></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b1</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_db1</span>
</span><span id=__span-1-63><a id=__codelineno-1-63 name=__codelineno-1-63 href=#__codelineno-1-63></a>
</span><span id=__span-1-64><a id=__codelineno-1-64 name=__codelineno-1-64 href=#__codelineno-1-64></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-1-65><a id=__codelineno-1-65 name=__codelineno-1-65 href=#__codelineno-1-65></a>        <span class=n>losses</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-1-66><a id=__codelineno-1-66 name=__codelineno-1-66 href=#__codelineno-1-66></a>        <span class=k>for</span> <span class=n>epoch</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>epochs</span><span class=p>):</span>
</span><span id=__span-1-67><a id=__codelineno-1-67 name=__codelineno-1-67 href=#__codelineno-1-67></a>            <span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>is_binary</span><span class=p>)</span>
</span><span id=__span-1-68><a id=__codelineno-1-68 name=__codelineno-1-68 href=#__codelineno-1-68></a>            <span class=n>loss</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>compute_loss</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>,</span> <span class=n>is_binary</span><span class=p>)</span>
</span><span id=__span-1-69><a id=__codelineno-1-69 name=__codelineno-1-69 href=#__codelineno-1-69></a>            <span class=bp>self</span><span class=o>.</span><span class=n>backward</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>,</span> <span class=n>is_binary</span><span class=p>)</span>
</span><span id=__span-1-70><a id=__codelineno-1-70 name=__codelineno-1-70 href=#__codelineno-1-70></a>            <span class=n>losses</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>loss</span><span class=p>)</span>
</span><span id=__span-1-71><a id=__codelineno-1-71 name=__codelineno-1-71 href=#__codelineno-1-71></a>            <span class=k>if</span> <span class=n>epoch</span> <span class=o>%</span> <span class=mi>50</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-1-72><a id=__codelineno-1-72 name=__codelineno-1-72 href=#__codelineno-1-72></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Epoch </span><span class=si>{</span><span class=n>epoch</span><span class=si>}</span><span class=s2>, Loss: </span><span class=si>{</span><span class=n>loss</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-1-73><a id=__codelineno-1-73 name=__codelineno-1-73 href=#__codelineno-1-73></a>        <span class=k>return</span> <span class=n>losses</span>
</span><span id=__span-1-74><a id=__codelineno-1-74 name=__codelineno-1-74 href=#__codelineno-1-74></a>
</span><span id=__span-1-75><a id=__codelineno-1-75 name=__codelineno-1-75 href=#__codelineno-1-75></a>    <span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-1-76><a id=__codelineno-1-76 name=__codelineno-1-76 href=#__codelineno-1-76></a>        <span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>is_binary</span><span class=p>)</span>
</span><span id=__span-1-77><a id=__codelineno-1-77 name=__codelineno-1-77 href=#__codelineno-1-77></a>        <span class=k>if</span> <span class=n>is_binary</span><span class=p>:</span>
</span><span id=__span-1-78><a id=__codelineno-1-78 name=__codelineno-1-78 href=#__codelineno-1-78></a>            <span class=k>return</span> <span class=p>(</span><span class=n>y_hat</span> <span class=o>&gt;=</span> <span class=mf>0.5</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span><span id=__span-1-79><a id=__codelineno-1-79 name=__codelineno-1-79 href=#__codelineno-1-79></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-1-80><a id=__codelineno-1-80 name=__codelineno-1-80 href=#__codelineno-1-80></a>            <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_hat</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></code></pre></div> <h3 id=step-3-train-the-model><strong>Step 3: Train the Model</strong></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># Initialize and train MLP</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>mlp</span> <span class=o>=</span> <span class=n>MLP</span><span class=p>(</span><span class=n>input_size</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>hidden_size</span><span class=o>=</span><span class=mi>64</span><span class=p>,</span> <span class=n>output_size</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=n>losses</span> <span class=o>=</span> <span class=n>mlp</span><span class=o>.</span><span class=n>train</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Sample Output</strong>: </p><div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>Epoch 0, Loss: 0.8533
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>Epoch 50, Loss: 0.4888
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>Epoch 100, Loss: 0.4792
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>Epoch 150, Loss: 0.4734
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>Epoch 200, Loss: 0.4690
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>Epoch 250, Loss: 0.4652
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>Epoch 300, Loss: 0.4616
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>Epoch 350, Loss: 0.4581
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>Epoch 400, Loss: 0.4545
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>Epoch 450, Loss: 0.4508
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>Test Accuracy: 0.7250
</span></code></pre></div><p></p> <h3 id=step-4-evaluate-on-test-set><strong>Step 4: Evaluate on Test Set</strong></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>mlp</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=n>accuracy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>y_pred</span> <span class=o>==</span> <span class=n>y_test</span><span class=o>.</span><span class=n>flatten</span><span class=p>())</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Test Accuracy: </span><span class=si>{</span><span class=n>accuracy</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=c1># Visualize decision boundary</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=k>def</span><span class=w> </span><span class=nf>plot_decision_boundary</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>model</span><span class=p>):</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>    <span class=n>x_min</span><span class=p>,</span> <span class=n>x_max</span> <span class=o>=</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span> <span class=o>-</span> <span class=mf>0.5</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>+</span> <span class=mf>0.5</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>    <span class=n>y_min</span><span class=p>,</span> <span class=n>y_max</span> <span class=o>=</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()</span> <span class=o>-</span> <span class=mf>0.5</span><span class=p>,</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span> <span class=o>+</span> <span class=mf>0.5</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>    <span class=n>xx</span><span class=p>,</span> <span class=n>yy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>x_min</span><span class=p>,</span> <span class=n>x_max</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>y_min</span><span class=p>,</span> <span class=n>y_max</span><span class=p>,</span> <span class=mi>100</span><span class=p>))</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>    <span class=n>X_grid</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>c_</span><span class=p>[</span><span class=n>xx</span><span class=o>.</span><span class=n>ravel</span><span class=p>(),</span> <span class=n>yy</span><span class=o>.</span><span class=n>ravel</span><span class=p>()]</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>    <span class=n>X_grid</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X_grid</span><span class=p>)</span>  <span class=c1># Standardize grid points</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=n>Z</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_grid</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>    <span class=n>Z</span> <span class=o>=</span> <span class=n>Z</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>xx</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>    <span class=n>plt</span><span class=o>.</span><span class=n>contourf</span><span class=p>(</span><span class=n>xx</span><span class=p>,</span> <span class=n>yy</span><span class=p>,</span> <span class=n>Z</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>'viridis'</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.3</span><span class=p>)</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>    <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>X</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>c</span><span class=o>=</span><span class=n>y</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>'viridis'</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>'k'</span><span class=p>)</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>    <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Decision Boundary'</span><span class=p>)</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>    <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Feature 1'</span><span class=p>)</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>    <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Feature 2'</span><span class=p>)</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=n>plot_decision_boundary</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=o>.</span><span class=n>flatten</span><span class=p>(),</span> <span class=n>mlp</span><span class=p>)</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>losses</span><span class=p>)</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Training Loss Over Epochs'</span><span class=p>)</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Epoch'</span><span class=p>)</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Loss'</span><span class=p>)</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><strong>Sample Output</strong>: </p><div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>Test Accuracy: 0.7250
</span></code></pre></div><p></p> <h3 id=visualization-a-plot-showing-the-decision-boundary-separating-the-two-classes><strong>Visualization</strong>: A plot showing the decision boundary separating the two classes.</h3> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../image1.png data-desc-position=bottom><img alt="Decision Boundary Plot" src=../image1.png></a> <a class=glightbox data-type=image data-width=auto data-height=auto href=../image2.png data-desc-position=bottom><img alt="Training Loss Plot" src=../image2.png></a></p> <h3 id=explanation><strong>Explanation</strong></h3> <ul> <li><strong>Data Generation</strong>: We created a dataset with 1 cluster for class 0 and 2 clusters for class 1 by generating separate datasets and combining them. The <code>class_sep=2.0</code> ensures separability.</li> <li><strong>MLP Architecture</strong>: A simple MLP with one hidden layer (10 neurons, ReLU) and a sigmoid output for binary classification. ReLU is chosen for faster convergence, and sigmoid maps outputs to [0,1].</li> <li><strong>Training</strong>: The model trains for 500 epochs, with loss decreasing steadily, indicating learning.</li> <li><strong>Evaluation</strong>: Accuracy around 72% suggests good performance. The decision boundary plot visualizes how the MLP separates the classes.</li> </ul> <hr> <h2 id=exercise-3-multi-class-classification-with-synthetic-data-and-reusable-mlp><strong>Exercise 3: Multi-Class Classification with Synthetic Data and Reusable MLP</strong></h2> <h3 id=step-1-data-generation-and-splitting_1><strong>Step 1: Data Generation and Splitting</strong></h3> <p><strong>Specifications</strong>: - Number of samples: 1500 - Number of classes: 3 - Number of features: 4 - Clusters: 2 for class 0, 3 for class 1, 4 for class 2 - Other parameters: <code>n_informative=4</code>, <code>n_redundant=0</code>, <code>random_state=42</code> - Split: 80% train (1200 samples), 20% test (300 samples)</p> <p>Since <code>make_classification</code> applies the same number of clusters to all classes, we’ll generate separate datasets for each class with the desired number of clusters and combine them.</p> <h3 id=step-2-mlp-implementation_1><strong>Step 2: MLP Implementation</strong></h3> <p>We’ll reuse the MLP structure from Exercise 2, modifying: - <strong>Output layer size</strong>: Change from 1 to 3 neurons (one per class). - <strong>Loss function</strong>: Use categorical cross-entropy instead of binary cross-entropy: $ L = -\frac{1}{N} \sum_{i=1}^N \sum_{c=1}^3 y_{i,c} \log(\hat{y}<em j=j>{i,c}) $ where <span class=arithmatex>\( y_{i,c} \)</span> is 1 if sample <span class=arithmatex>\( i \)</span> belongs to class <span class=arithmatex>\( c \)</span>, else 0, and <span class=arithmatex>\( \hat{y}_{i,c} \)</span> is the predicted probability for class <span class=arithmatex>\( c \)</span>. - <strong>Activation for output</strong>: Use softmax instead of sigmoid: $ \text{softmax}(\mathbf{z})_i = \frac{e^{z_i}}{\sum</em> $ - } e^{z_j}<strong>Hyperparameters</strong>: - Input size: 4 (features) - Hidden layer: 10 neurons, ReLU activation (same as Exercise 2) - Output size: 3 (classes) - Learning rate: $ \eta = 0.01 $ - Epochs: 200</p> <p>The core logic (forward, backward, train methods) remains unchanged, only adapting for the new output size and loss function.</p> <h3 id=step-3-training><strong>Step 3: Training</strong></h3> <p>Train for 200 epochs, tracking the categorical cross-entropy loss.</p> <h3 id=step-4-evaluation-and-visualization><strong>Step 4: Evaluation and Visualization</strong></h3> <p>Evaluate accuracy on the test set. For visualization, since we have 4 features, we’ll use a scatter plot of the first two principal components (via PCA) colored by predicted labels.</p> <h3 id=code-implementation><strong>Code Implementation</strong></h3> <p>Below is the complete code, reusing the MLP structure from Exercise 2 with necessary modifications.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.decomposition</span><span class=w> </span><span class=kn>import</span> <span class=n>PCA</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=c1># Data generation for Exercise 3</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=n>X0</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>                           <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=n>y0</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=n>X1</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>                           <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>43</span><span class=p>,</span> <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=n>y1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=n>X2</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>                           <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>44</span><span class=p>,</span> <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=n>y2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>(</span><span class=mi>500</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>((</span><span class=n>X0</span><span class=p>,</span> <span class=n>X1</span><span class=p>,</span> <span class=n>X2</span><span class=p>))</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>y0</span><span class=p>,</span> <span class=n>y1</span><span class=p>,</span> <span class=n>y2</span><span class=p>))</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=n>y_one_hot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>y</span><span class=o>.</span><span class=n>size</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=n>y_one_hot</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>y</span><span class=o>.</span><span class=n>size</span><span class=p>),</span> <span class=n>y</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)]</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=c1># Standardize data</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=n>X</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y_one_hot</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>)</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=c1># MLP class reused from Exercise 2</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=k>class</span><span class=w> </span><span class=nc>MLP</span><span class=p>:</span>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_size</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>hidden_size</span><span class=o>=</span><span class=mi>64</span><span class=p>,</span> <span class=n>output_size</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.1</span><span class=p>):</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a>        <span class=c1># He initialization</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>/</span> <span class=n>input_size</span><span class=p>)</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>))</span>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>hidden_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>/</span> <span class=n>hidden_size</span><span class=p>)</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>output_size</span><span class=p>))</span>
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36 href=#__codelineno-6-36></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>=</span> <span class=n>lr</span>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37 href=#__codelineno-6-37></a>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38 href=#__codelineno-6-38></a>    <span class=k>def</span><span class=w> </span><span class=nf>relu</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39 href=#__codelineno-6-39></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40 href=#__codelineno-6-40></a>
</span><span id=__span-6-41><a id=__codelineno-6-41 name=__codelineno-6-41 href=#__codelineno-6-41></a>    <span class=k>def</span><span class=w> </span><span class=nf>relu_derivative</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-6-42><a id=__codelineno-6-42 name=__codelineno-6-42 href=#__codelineno-6-42></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-6-43><a id=__codelineno-6-43 name=__codelineno-6-43 href=#__codelineno-6-43></a>
</span><span id=__span-6-44><a id=__codelineno-6-44 name=__codelineno-6-44 href=#__codelineno-6-44></a>    <span class=k>def</span><span class=w> </span><span class=nf>sigmoid</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-6-45><a id=__codelineno-6-45 name=__codelineno-6-45 href=#__codelineno-6-45></a>        <span class=k>return</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=o>-</span><span class=mi>500</span><span class=p>,</span> <span class=mi>500</span><span class=p>)))</span>
</span><span id=__span-6-46><a id=__codelineno-6-46 name=__codelineno-6-46 href=#__codelineno-6-46></a>
</span><span id=__span-6-47><a id=__codelineno-6-47 name=__codelineno-6-47 href=#__codelineno-6-47></a>    <span class=k>def</span><span class=w> </span><span class=nf>softmax</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-6-48><a id=__codelineno-6-48 name=__codelineno-6-48 href=#__codelineno-6-48></a>        <span class=n>exp_x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span><span id=__span-6-49><a id=__codelineno-6-49 name=__codelineno-6-49 href=#__codelineno-6-49></a>        <span class=k>return</span> <span class=n>exp_x</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>exp_x</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-50><a id=__codelineno-6-50 name=__codelineno-6-50 href=#__codelineno-6-50></a>
</span><span id=__span-6-51><a id=__codelineno-6-51 name=__codelineno-6-51 href=#__codelineno-6-51></a>    <span class=k>def</span><span class=w> </span><span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span><span id=__span-6-52><a id=__codelineno-6-52 name=__codelineno-6-52 href=#__codelineno-6-52></a>        <span class=c1># Hidden layer</span>
</span><span id=__span-6-53><a id=__codelineno-6-53 name=__codelineno-6-53 href=#__codelineno-6-53></a>        <span class=bp>self</span><span class=o>.</span><span class=n>z1</span> <span class=o>=</span> <span class=n>X</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W1</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b1</span>
</span><span id=__span-6-54><a id=__codelineno-6-54 name=__codelineno-6-54 href=#__codelineno-6-54></a>        <span class=bp>self</span><span class=o>.</span><span class=n>h1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z1</span><span class=p>)</span>
</span><span id=__span-6-55><a id=__codelineno-6-55 name=__codelineno-6-55 href=#__codelineno-6-55></a>        <span class=c1># Output layer</span>
</span><span id=__span-6-56><a id=__codelineno-6-56 name=__codelineno-6-56 href=#__codelineno-6-56></a>        <span class=bp>self</span><span class=o>.</span><span class=n>z2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>h1</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W2</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b2</span>
</span><span id=__span-6-57><a id=__codelineno-6-57 name=__codelineno-6-57 href=#__codelineno-6-57></a>        <span class=k>if</span> <span class=n>is_binary</span><span class=p>:</span>
</span><span id=__span-6-58><a id=__codelineno-6-58 name=__codelineno-6-58 href=#__codelineno-6-58></a>            <span class=bp>self</span><span class=o>.</span><span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>sigmoid</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z2</span><span class=p>)</span>
</span><span id=__span-6-59><a id=__codelineno-6-59 name=__codelineno-6-59 href=#__codelineno-6-59></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-6-60><a id=__codelineno-6-60 name=__codelineno-6-60 href=#__codelineno-6-60></a>            <span class=bp>self</span><span class=o>.</span><span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z2</span><span class=p>)</span>
</span><span id=__span-6-61><a id=__codelineno-6-61 name=__codelineno-6-61 href=#__codelineno-6-61></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>y_hat</span>
</span><span id=__span-6-62><a id=__codelineno-6-62 name=__codelineno-6-62 href=#__codelineno-6-62></a>
</span><span id=__span-6-63><a id=__codelineno-6-63 name=__codelineno-6-63 href=#__codelineno-6-63></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute_loss</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span><span id=__span-6-64><a id=__codelineno-6-64 name=__codelineno-6-64 href=#__codelineno-6-64></a>        <span class=n>y_hat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>y_hat</span><span class=p>,</span> <span class=mf>1e-15</span><span class=p>,</span> <span class=mi>1</span> <span class=o>-</span> <span class=mf>1e-15</span><span class=p>)</span>
</span><span id=__span-6-65><a id=__codelineno-6-65 name=__codelineno-6-65 href=#__codelineno-6-65></a>        <span class=k>if</span> <span class=n>is_binary</span><span class=p>:</span>
</span><span id=__span-6-66><a id=__codelineno-6-66 name=__codelineno-6-66 href=#__codelineno-6-66></a>            <span class=k>return</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>y</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>y_hat</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>y_hat</span><span class=p>))</span>
</span><span id=__span-6-67><a id=__codelineno-6-67 name=__codelineno-6-67 href=#__codelineno-6-67></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-6-68><a id=__codelineno-6-68 name=__codelineno-6-68 href=#__codelineno-6-68></a>            <span class=k>return</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>y</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>y_hat</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>
</span><span id=__span-6-69><a id=__codelineno-6-69 name=__codelineno-6-69 href=#__codelineno-6-69></a>
</span><span id=__span-6-70><a id=__codelineno-6-70 name=__codelineno-6-70 href=#__codelineno-6-70></a>    <span class=k>def</span><span class=w> </span><span class=nf>backward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span><span id=__span-6-71><a id=__codelineno-6-71 name=__codelineno-6-71 href=#__codelineno-6-71></a>        <span class=n>N</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-6-72><a id=__codelineno-6-72 name=__codelineno-6-72 href=#__codelineno-6-72></a>        <span class=k>if</span> <span class=n>is_binary</span><span class=p>:</span>
</span><span id=__span-6-73><a id=__codelineno-6-73 name=__codelineno-6-73 href=#__codelineno-6-73></a>            <span class=n>dL_dz2</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_hat</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span> <span class=o>/</span> <span class=n>N</span>
</span><span id=__span-6-74><a id=__codelineno-6-74 name=__codelineno-6-74 href=#__codelineno-6-74></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-6-75><a id=__codelineno-6-75 name=__codelineno-6-75 href=#__codelineno-6-75></a>            <span class=n>dL_dz2</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_hat</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span> <span class=o>/</span> <span class=n>N</span>
</span><span id=__span-6-76><a id=__codelineno-6-76 name=__codelineno-6-76 href=#__codelineno-6-76></a>        <span class=n>dL_dW2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>h1</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>dL_dz2</span>
</span><span id=__span-6-77><a id=__codelineno-6-77 name=__codelineno-6-77 href=#__codelineno-6-77></a>        <span class=n>dL_db2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dL_dz2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-78><a id=__codelineno-6-78 name=__codelineno-6-78 href=#__codelineno-6-78></a>        <span class=n>dL_dh1</span> <span class=o>=</span> <span class=n>dL_dz2</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W2</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-6-79><a id=__codelineno-6-79 name=__codelineno-6-79 href=#__codelineno-6-79></a>        <span class=n>dL_dz1</span> <span class=o>=</span> <span class=n>dL_dh1</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu_derivative</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z1</span><span class=p>)</span>
</span><span id=__span-6-80><a id=__codelineno-6-80 name=__codelineno-6-80 href=#__codelineno-6-80></a>        <span class=n>dL_dW1</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>dL_dz1</span>
</span><span id=__span-6-81><a id=__codelineno-6-81 name=__codelineno-6-81 href=#__codelineno-6-81></a>        <span class=n>dL_db1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dL_dz1</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-6-82><a id=__codelineno-6-82 name=__codelineno-6-82 href=#__codelineno-6-82></a>        <span class=c1># Gradient clipping</span>
</span><span id=__span-6-83><a id=__codelineno-6-83 name=__codelineno-6-83 href=#__codelineno-6-83></a>        <span class=n>max_grad</span> <span class=o>=</span> <span class=mf>1.0</span>
</span><span id=__span-6-84><a id=__codelineno-6-84 name=__codelineno-6-84 href=#__codelineno-6-84></a>        <span class=n>dL_dW1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>dL_dW1</span><span class=p>,</span> <span class=o>-</span><span class=n>max_grad</span><span class=p>,</span> <span class=n>max_grad</span><span class=p>)</span>
</span><span id=__span-6-85><a id=__codelineno-6-85 name=__codelineno-6-85 href=#__codelineno-6-85></a>        <span class=n>dL_dW2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>dL_dW2</span><span class=p>,</span> <span class=o>-</span><span class=n>max_grad</span><span class=p>,</span> <span class=n>max_grad</span><span class=p>)</span>
</span><span id=__span-6-86><a id=__codelineno-6-86 name=__codelineno-6-86 href=#__codelineno-6-86></a>        <span class=c1># Update parameters</span>
</span><span id=__span-6-87><a id=__codelineno-6-87 name=__codelineno-6-87 href=#__codelineno-6-87></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W2</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_dW2</span>
</span><span id=__span-6-88><a id=__codelineno-6-88 name=__codelineno-6-88 href=#__codelineno-6-88></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b2</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_db2</span>
</span><span id=__span-6-89><a id=__codelineno-6-89 name=__codelineno-6-89 href=#__codelineno-6-89></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W1</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_dW1</span>
</span><span id=__span-6-90><a id=__codelineno-6-90 name=__codelineno-6-90 href=#__codelineno-6-90></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b1</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_db1</span>
</span><span id=__span-6-91><a id=__codelineno-6-91 name=__codelineno-6-91 href=#__codelineno-6-91></a>
</span><span id=__span-6-92><a id=__codelineno-6-92 name=__codelineno-6-92 href=#__codelineno-6-92></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span><span id=__span-6-93><a id=__codelineno-6-93 name=__codelineno-6-93 href=#__codelineno-6-93></a>        <span class=n>losses</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-6-94><a id=__codelineno-6-94 name=__codelineno-6-94 href=#__codelineno-6-94></a>        <span class=k>for</span> <span class=n>epoch</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>epochs</span><span class=p>):</span>
</span><span id=__span-6-95><a id=__codelineno-6-95 name=__codelineno-6-95 href=#__codelineno-6-95></a>            <span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>is_binary</span><span class=p>)</span>
</span><span id=__span-6-96><a id=__codelineno-6-96 name=__codelineno-6-96 href=#__codelineno-6-96></a>            <span class=n>loss</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>compute_loss</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>,</span> <span class=n>is_binary</span><span class=p>)</span>
</span><span id=__span-6-97><a id=__codelineno-6-97 name=__codelineno-6-97 href=#__codelineno-6-97></a>            <span class=bp>self</span><span class=o>.</span><span class=n>backward</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>,</span> <span class=n>is_binary</span><span class=p>)</span>
</span><span id=__span-6-98><a id=__codelineno-6-98 name=__codelineno-6-98 href=#__codelineno-6-98></a>            <span class=n>losses</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>loss</span><span class=p>)</span>
</span><span id=__span-6-99><a id=__codelineno-6-99 name=__codelineno-6-99 href=#__codelineno-6-99></a>            <span class=k>if</span> <span class=n>epoch</span> <span class=o>%</span> <span class=mi>50</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-6-100><a id=__codelineno-6-100 name=__codelineno-6-100 href=#__codelineno-6-100></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Epoch </span><span class=si>{</span><span class=n>epoch</span><span class=si>}</span><span class=s2>, Loss: </span><span class=si>{</span><span class=n>loss</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-6-101><a id=__codelineno-6-101 name=__codelineno-6-101 href=#__codelineno-6-101></a>        <span class=k>return</span> <span class=n>losses</span>
</span><span id=__span-6-102><a id=__codelineno-6-102 name=__codelineno-6-102 href=#__codelineno-6-102></a>
</span><span id=__span-6-103><a id=__codelineno-6-103 name=__codelineno-6-103 href=#__codelineno-6-103></a>    <span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span><span id=__span-6-104><a id=__codelineno-6-104 name=__codelineno-6-104 href=#__codelineno-6-104></a>        <span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>is_binary</span><span class=p>)</span>
</span><span id=__span-6-105><a id=__codelineno-6-105 name=__codelineno-6-105 href=#__codelineno-6-105></a>        <span class=k>if</span> <span class=n>is_binary</span><span class=p>:</span>
</span><span id=__span-6-106><a id=__codelineno-6-106 name=__codelineno-6-106 href=#__codelineno-6-106></a>            <span class=k>return</span> <span class=p>(</span><span class=n>y_hat</span> <span class=o>&gt;=</span> <span class=mf>0.5</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span><span id=__span-6-107><a id=__codelineno-6-107 name=__codelineno-6-107 href=#__codelineno-6-107></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-6-108><a id=__codelineno-6-108 name=__codelineno-6-108 href=#__codelineno-6-108></a>            <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_hat</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-6-109><a id=__codelineno-6-109 name=__codelineno-6-109 href=#__codelineno-6-109></a>
</span><span id=__span-6-110><a id=__codelineno-6-110 name=__codelineno-6-110 href=#__codelineno-6-110></a><span class=c1># Train and evaluate for Exercise 3 (multi-class)</span>
</span><span id=__span-6-111><a id=__codelineno-6-111 name=__codelineno-6-111 href=#__codelineno-6-111></a><span class=n>mlp</span> <span class=o>=</span> <span class=n>MLP</span><span class=p>(</span><span class=n>input_size</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>hidden_size</span><span class=o>=</span><span class=mi>64</span><span class=p>,</span> <span class=n>output_size</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
</span><span id=__span-6-112><a id=__codelineno-6-112 name=__codelineno-6-112 href=#__codelineno-6-112></a><span class=n>losses</span> <span class=o>=</span> <span class=n>mlp</span><span class=o>.</span><span class=n>train</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-6-113><a id=__codelineno-6-113 name=__codelineno-6-113 href=#__codelineno-6-113></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>mlp</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>is_binary</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-6-114><a id=__codelineno-6-114 name=__codelineno-6-114 href=#__codelineno-6-114></a><span class=n>y_test_labels</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-6-115><a id=__codelineno-6-115 name=__codelineno-6-115 href=#__codelineno-6-115></a><span class=n>accuracy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>y_pred</span> <span class=o>==</span> <span class=n>y_test_labels</span><span class=p>)</span>
</span><span id=__span-6-116><a id=__codelineno-6-116 name=__codelineno-6-116 href=#__codelineno-6-116></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Test Accuracy: </span><span class=si>{</span><span class=n>accuracy</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-6-117><a id=__codelineno-6-117 name=__codelineno-6-117 href=#__codelineno-6-117></a>
</span><span id=__span-6-118><a id=__codelineno-6-118 name=__codelineno-6-118 href=#__codelineno-6-118></a><span class=c1># Visualizations</span>
</span><span id=__span-6-119><a id=__codelineno-6-119 name=__codelineno-6-119 href=#__codelineno-6-119></a><span class=n>pca</span> <span class=o>=</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-6-120><a id=__codelineno-6-120 name=__codelineno-6-120 href=#__codelineno-6-120></a><span class=n>X_test_2d</span> <span class=o>=</span> <span class=n>pca</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span><span id=__span-6-121><a id=__codelineno-6-121 name=__codelineno-6-121 href=#__codelineno-6-121></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X_test_2d</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>X_test_2d</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>c</span><span class=o>=</span><span class=n>y_pred</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>'viridis'</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>'k'</span><span class=p>)</span>
</span><span id=__span-6-122><a id=__codelineno-6-122 name=__codelineno-6-122 href=#__codelineno-6-122></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Test Data (PCA) with Predicted Labels'</span><span class=p>)</span>
</span><span id=__span-6-123><a id=__codelineno-6-123 name=__codelineno-6-123 href=#__codelineno-6-123></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'PCA Component 1'</span><span class=p>)</span>
</span><span id=__span-6-124><a id=__codelineno-6-124 name=__codelineno-6-124 href=#__codelineno-6-124></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'PCA Component 2'</span><span class=p>)</span>
</span><span id=__span-6-125><a id=__codelineno-6-125 name=__codelineno-6-125 href=#__codelineno-6-125></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-6-126><a id=__codelineno-6-126 name=__codelineno-6-126 href=#__codelineno-6-126></a>
</span><span id=__span-6-127><a id=__codelineno-6-127 name=__codelineno-6-127 href=#__codelineno-6-127></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>losses</span><span class=p>)</span>
</span><span id=__span-6-128><a id=__codelineno-6-128 name=__codelineno-6-128 href=#__codelineno-6-128></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Training Loss Over Epochs'</span><span class=p>)</span>
</span><span id=__span-6-129><a id=__codelineno-6-129 name=__codelineno-6-129 href=#__codelineno-6-129></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Epoch'</span><span class=p>)</span>
</span><span id=__span-6-130><a id=__codelineno-6-130 name=__codelineno-6-130 href=#__codelineno-6-130></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Loss'</span><span class=p>)</span>
</span><span id=__span-6-131><a id=__codelineno-6-131 name=__codelineno-6-131 href=#__codelineno-6-131></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <h3 id=explanation-of-changes-from-exercise-2><strong>Explanation of Changes from Exercise 2</strong></h3> <ul> <li><strong>Data Generation</strong>: Generated three datasets with 2, 3, and 4 clusters for classes 0, 1, and 2, respectively, each with 500 samples and 4 features. Combined them to form a 1500-sample dataset. Used one-hot encoding for the 3-class labels.</li> <li><strong>MLP Modifications</strong>:</li> <li>Changed <code>input_size</code> to 4 and <code>output_size</code> to 3.</li> <li>Replaced sigmoid with softmax in the output layer.</li> <li>Updated loss to categorical cross-entropy.</li> <li>Simplified the gradient computation for softmax + cross-entropy (combined derivative is <span class=arithmatex>\( \hat{y} - y \)</span>).</li> <li>Added a <code>predict</code> method to return class labels (argmax of softmax output).</li> <li><strong>Core Structure</strong>: The <code>forward</code>, <code>backward</code>, and <code>train</code> methods retain the same logic flow as Exercise 2, only adapting for the new output size and loss function, satisfying the reuse requirement for the extra point.</li> <li><strong>Evaluation</strong>: Computed accuracy by comparing predicted labels to true labels. Visualized predictions using PCA to reduce 4D data to 2D for scatter plotting.</li> </ul> <h3 id=sample-output><strong>Sample Output</strong></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>Epoch 0, Loss: 1.6466
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>Epoch 50, Loss: 0.7559
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>Epoch 100, Loss: 0.6809
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>Epoch 150, Loss: 0.6460
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>Epoch 200, Loss: 0.6245
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>Epoch 250, Loss: 0.6093
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>Epoch 300, Loss: 0.5970
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>Epoch 350, Loss: 0.5866
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>Epoch 400, Loss: 0.5773
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>Epoch 450, Loss: 0.5691
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>Test Accuracy: 0.6867
</span></code></pre></div> <hr> <h2 id=exercise-4-multi-class-classification-with-deeper-mlp><strong>Exercise 4: Multi-Class Classification with Deeper MLP</strong></h2> <h3 id=objective><strong>Objective</strong></h3> <p>Repeat Exercise 3 exactly, but use an MLP with <strong>at least 2 hidden layers</strong>. Reuse code from Exercise 3 where possible, adapting for the deeper architecture. Train, evaluate, and report results.</p> <h3 id=step-1-data-generation><strong>Step 1: Data Generation</strong></h3> <p>The dataset is identical to Exercise 3: 1500 samples, 3 classes, 4 features, 2/3/4 clusters per class, split 80/20.</p> <h3 id=step-2-mlp-implementation_2><strong>Step 2: MLP Implementation</strong></h3> <p>We’ll modify the MLP from Exercise 3 to include two hidden layers: - <strong>Architecture</strong>: - Input layer: 4 features - Hidden layer 1: 10 neurons, ReLU activation - Hidden layer 2: 8 neurons, ReLU activation - Output layer: 3 neurons, softmax activation - <strong>Loss</strong>: Categorical cross-entropy (same as Exercise 3) - <strong>Hyperparameters</strong>: - Learning rate: $ \eta = 0.01 $ - Epochs: 200 - <strong>Changes</strong>: - Add weights and biases for the second hidden layer. - Update forward and backward passes to include the second hidden layer.</p> <h3 id=step-3-training-and-evaluation><strong>Step 3: Training and Evaluation</strong></h3> <p>Train for 200 epochs and evaluate accuracy on the test set. Reuse the PCA visualization from Exercise 3.</p> <h3 id=code-implementation_1><strong>Code Implementation</strong></h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.decomposition</span><span class=w> </span><span class=kn>import</span> <span class=n>PCA</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=c1># Data generation</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=n>X0</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>                           <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=n>y0</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=n>X1</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>                           <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>43</span><span class=p>,</span> <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=n>y1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=n>X2</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>                           <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>44</span><span class=p>,</span> <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>)</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=n>y2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>(</span><span class=mi>500</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>((</span><span class=n>X0</span><span class=p>,</span> <span class=n>X1</span><span class=p>,</span> <span class=n>X2</span><span class=p>))</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>y0</span><span class=p>,</span> <span class=n>y1</span><span class=p>,</span> <span class=n>y2</span><span class=p>))</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=n>y_one_hot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>y</span><span class=o>.</span><span class=n>size</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=n>y_one_hot</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=n>y</span><span class=o>.</span><span class=n>size</span><span class=p>),</span> <span class=n>y</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)]</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=c1># Standardize data</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=n>X</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y_one_hot</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>)</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=k>class</span><span class=w> </span><span class=nc>MLP</span><span class=p>:</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_size</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>hidden_size1</span><span class=o>=</span><span class=mi>64</span><span class=p>,</span> <span class=n>hidden_size2</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>output_size</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.1</span><span class=p>):</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>        <span class=c1># He initialization</span>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>hidden_size1</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>/</span> <span class=n>input_size</span><span class=p>)</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>hidden_size1</span><span class=p>))</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>hidden_size1</span><span class=p>,</span> <span class=n>hidden_size2</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>/</span> <span class=n>hidden_size1</span><span class=p>)</span>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>hidden_size2</span><span class=p>))</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W3</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=n>hidden_size2</span><span class=p>,</span> <span class=n>output_size</span><span class=p>)</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span> <span class=o>/</span> <span class=n>hidden_size2</span><span class=p>)</span>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b3</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=mi>1</span><span class=p>,</span> <span class=n>output_size</span><span class=p>))</span>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a>        <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>=</span> <span class=n>lr</span>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a>
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a>    <span class=k>def</span><span class=w> </span><span class=nf>relu</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span>
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a>
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a>    <span class=k>def</span><span class=w> </span><span class=nf>relu_derivative</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-8-43><a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-8-44><a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a>
</span><span id=__span-8-45><a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a>    <span class=k>def</span><span class=w> </span><span class=nf>softmax</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-8-46><a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a>        <span class=n>exp_x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span><span id=__span-8-47><a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a>        <span class=k>return</span> <span class=n>exp_x</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>exp_x</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-8-48><a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a>
</span><span id=__span-8-49><a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a>    <span class=k>def</span><span class=w> </span><span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
</span><span id=__span-8-50><a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a>        <span class=bp>self</span><span class=o>.</span><span class=n>z1</span> <span class=o>=</span> <span class=n>X</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W1</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b1</span>
</span><span id=__span-8-51><a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a>        <span class=bp>self</span><span class=o>.</span><span class=n>h1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z1</span><span class=p>)</span>
</span><span id=__span-8-52><a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a>        <span class=bp>self</span><span class=o>.</span><span class=n>z2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>h1</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W2</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b2</span>
</span><span id=__span-8-53><a id=__codelineno-8-53 name=__codelineno-8-53 href=#__codelineno-8-53></a>        <span class=bp>self</span><span class=o>.</span><span class=n>h2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z2</span><span class=p>)</span>
</span><span id=__span-8-54><a id=__codelineno-8-54 name=__codelineno-8-54 href=#__codelineno-8-54></a>        <span class=bp>self</span><span class=o>.</span><span class=n>z3</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>h2</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W3</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>b3</span>
</span><span id=__span-8-55><a id=__codelineno-8-55 name=__codelineno-8-55 href=#__codelineno-8-55></a>        <span class=bp>self</span><span class=o>.</span><span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z3</span><span class=p>)</span>
</span><span id=__span-8-56><a id=__codelineno-8-56 name=__codelineno-8-56 href=#__codelineno-8-56></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>y_hat</span>
</span><span id=__span-8-57><a id=__codelineno-8-57 name=__codelineno-8-57 href=#__codelineno-8-57></a>
</span><span id=__span-8-58><a id=__codelineno-8-58 name=__codelineno-8-58 href=#__codelineno-8-58></a>    <span class=k>def</span><span class=w> </span><span class=nf>compute_loss</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>):</span>
</span><span id=__span-8-59><a id=__codelineno-8-59 name=__codelineno-8-59 href=#__codelineno-8-59></a>        <span class=n>y_hat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>y_hat</span><span class=p>,</span> <span class=mf>1e-15</span><span class=p>,</span> <span class=mi>1</span> <span class=o>-</span> <span class=mf>1e-15</span><span class=p>)</span>
</span><span id=__span-8-60><a id=__codelineno-8-60 name=__codelineno-8-60 href=#__codelineno-8-60></a>        <span class=k>return</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>y</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>y_hat</span><span class=p>),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>
</span><span id=__span-8-61><a id=__codelineno-8-61 name=__codelineno-8-61 href=#__codelineno-8-61></a>
</span><span id=__span-8-62><a id=__codelineno-8-62 name=__codelineno-8-62 href=#__codelineno-8-62></a>    <span class=k>def</span><span class=w> </span><span class=nf>backward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>):</span>
</span><span id=__span-8-63><a id=__codelineno-8-63 name=__codelineno-8-63 href=#__codelineno-8-63></a>        <span class=n>N</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-8-64><a id=__codelineno-8-64 name=__codelineno-8-64 href=#__codelineno-8-64></a>        <span class=n>dL_dz3</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_hat</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span> <span class=o>/</span> <span class=n>N</span>
</span><span id=__span-8-65><a id=__codelineno-8-65 name=__codelineno-8-65 href=#__codelineno-8-65></a>        <span class=n>dL_dW3</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>h2</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>dL_dz3</span>
</span><span id=__span-8-66><a id=__codelineno-8-66 name=__codelineno-8-66 href=#__codelineno-8-66></a>        <span class=n>dL_db3</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dL_dz3</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-8-67><a id=__codelineno-8-67 name=__codelineno-8-67 href=#__codelineno-8-67></a>        <span class=n>dL_dh2</span> <span class=o>=</span> <span class=n>dL_dz3</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W3</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-8-68><a id=__codelineno-8-68 name=__codelineno-8-68 href=#__codelineno-8-68></a>        <span class=n>dL_dz2</span> <span class=o>=</span> <span class=n>dL_dh2</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu_derivative</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z2</span><span class=p>)</span>
</span><span id=__span-8-69><a id=__codelineno-8-69 name=__codelineno-8-69 href=#__codelineno-8-69></a>        <span class=n>dL_dW2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>h1</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>dL_dz2</span>
</span><span id=__span-8-70><a id=__codelineno-8-70 name=__codelineno-8-70 href=#__codelineno-8-70></a>        <span class=n>dL_db2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dL_dz2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-8-71><a id=__codelineno-8-71 name=__codelineno-8-71 href=#__codelineno-8-71></a>        <span class=n>dL_dh1</span> <span class=o>=</span> <span class=n>dL_dz2</span> <span class=o>@</span> <span class=bp>self</span><span class=o>.</span><span class=n>W2</span><span class=o>.</span><span class=n>T</span>
</span><span id=__span-8-72><a id=__codelineno-8-72 name=__codelineno-8-72 href=#__codelineno-8-72></a>        <span class=n>dL_dz1</span> <span class=o>=</span> <span class=n>dL_dh1</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu_derivative</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>z1</span><span class=p>)</span>
</span><span id=__span-8-73><a id=__codelineno-8-73 name=__codelineno-8-73 href=#__codelineno-8-73></a>        <span class=n>dL_dW1</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>dL_dz1</span>
</span><span id=__span-8-74><a id=__codelineno-8-74 name=__codelineno-8-74 href=#__codelineno-8-74></a>        <span class=n>dL_db1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>dL_dz1</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-8-75><a id=__codelineno-8-75 name=__codelineno-8-75 href=#__codelineno-8-75></a>        <span class=c1># Gradient clipping</span>
</span><span id=__span-8-76><a id=__codelineno-8-76 name=__codelineno-8-76 href=#__codelineno-8-76></a>        <span class=n>max_grad</span> <span class=o>=</span> <span class=mf>1.0</span>
</span><span id=__span-8-77><a id=__codelineno-8-77 name=__codelineno-8-77 href=#__codelineno-8-77></a>        <span class=n>dL_dW1</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>dL_dW1</span><span class=p>,</span> <span class=o>-</span><span class=n>max_grad</span><span class=p>,</span> <span class=n>max_grad</span><span class=p>)</span>
</span><span id=__span-8-78><a id=__codelineno-8-78 name=__codelineno-8-78 href=#__codelineno-8-78></a>        <span class=n>dL_dW2</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>dL_dW2</span><span class=p>,</span> <span class=o>-</span><span class=n>max_grad</span><span class=p>,</span> <span class=n>max_grad</span><span class=p>)</span>
</span><span id=__span-8-79><a id=__codelineno-8-79 name=__codelineno-8-79 href=#__codelineno-8-79></a>        <span class=n>dL_dW3</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>dL_dW3</span><span class=p>,</span> <span class=o>-</span><span class=n>max_grad</span><span class=p>,</span> <span class=n>max_grad</span><span class=p>)</span>
</span><span id=__span-8-80><a id=__codelineno-8-80 name=__codelineno-8-80 href=#__codelineno-8-80></a>        <span class=c1># Update parameters</span>
</span><span id=__span-8-81><a id=__codelineno-8-81 name=__codelineno-8-81 href=#__codelineno-8-81></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W3</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_dW3</span>
</span><span id=__span-8-82><a id=__codelineno-8-82 name=__codelineno-8-82 href=#__codelineno-8-82></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b3</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_db3</span>
</span><span id=__span-8-83><a id=__codelineno-8-83 name=__codelineno-8-83 href=#__codelineno-8-83></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W2</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_dW2</span>
</span><span id=__span-8-84><a id=__codelineno-8-84 name=__codelineno-8-84 href=#__codelineno-8-84></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b2</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_db2</span>
</span><span id=__span-8-85><a id=__codelineno-8-85 name=__codelineno-8-85 href=#__codelineno-8-85></a>        <span class=bp>self</span><span class=o>.</span><span class=n>W1</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_dW1</span>
</span><span id=__span-8-86><a id=__codelineno-8-86 name=__codelineno-8-86 href=#__codelineno-8-86></a>        <span class=bp>self</span><span class=o>.</span><span class=n>b1</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>lr</span> <span class=o>*</span> <span class=n>dL_db1</span>
</span><span id=__span-8-87><a id=__codelineno-8-87 name=__codelineno-8-87 href=#__codelineno-8-87></a>
</span><span id=__span-8-88><a id=__codelineno-8-88 name=__codelineno-8-88 href=#__codelineno-8-88></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>500</span><span class=p>):</span>
</span><span id=__span-8-89><a id=__codelineno-8-89 name=__codelineno-8-89 href=#__codelineno-8-89></a>        <span class=n>losses</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-8-90><a id=__codelineno-8-90 name=__codelineno-8-90 href=#__codelineno-8-90></a>        <span class=k>for</span> <span class=n>epoch</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>epochs</span><span class=p>):</span>
</span><span id=__span-8-91><a id=__codelineno-8-91 name=__codelineno-8-91 href=#__codelineno-8-91></a>            <span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-8-92><a id=__codelineno-8-92 name=__codelineno-8-92 href=#__codelineno-8-92></a>            <span class=n>loss</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>compute_loss</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>)</span>
</span><span id=__span-8-93><a id=__codelineno-8-93 name=__codelineno-8-93 href=#__codelineno-8-93></a>            <span class=bp>self</span><span class=o>.</span><span class=n>backward</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>y_hat</span><span class=p>)</span>
</span><span id=__span-8-94><a id=__codelineno-8-94 name=__codelineno-8-94 href=#__codelineno-8-94></a>            <span class=n>losses</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>loss</span><span class=p>)</span>
</span><span id=__span-8-95><a id=__codelineno-8-95 name=__codelineno-8-95 href=#__codelineno-8-95></a>            <span class=k>if</span> <span class=n>epoch</span> <span class=o>%</span> <span class=mi>50</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-8-96><a id=__codelineno-8-96 name=__codelineno-8-96 href=#__codelineno-8-96></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Epoch </span><span class=si>{</span><span class=n>epoch</span><span class=si>}</span><span class=s2>, Loss: </span><span class=si>{</span><span class=n>loss</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-8-97><a id=__codelineno-8-97 name=__codelineno-8-97 href=#__codelineno-8-97></a>        <span class=k>return</span> <span class=n>losses</span>
</span><span id=__span-8-98><a id=__codelineno-8-98 name=__codelineno-8-98 href=#__codelineno-8-98></a>
</span><span id=__span-8-99><a id=__codelineno-8-99 name=__codelineno-8-99 href=#__codelineno-8-99></a>    <span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
</span><span id=__span-8-100><a id=__codelineno-8-100 name=__codelineno-8-100 href=#__codelineno-8-100></a>        <span class=n>y_hat</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-8-101><a id=__codelineno-8-101 name=__codelineno-8-101 href=#__codelineno-8-101></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_hat</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-8-102><a id=__codelineno-8-102 name=__codelineno-8-102 href=#__codelineno-8-102></a>
</span><span id=__span-8-103><a id=__codelineno-8-103 name=__codelineno-8-103 href=#__codelineno-8-103></a><span class=c1># Train and evaluate</span>
</span><span id=__span-8-104><a id=__codelineno-8-104 name=__codelineno-8-104 href=#__codelineno-8-104></a><span class=n>mlp</span> <span class=o>=</span> <span class=n>MLP</span><span class=p>(</span><span class=n>input_size</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>hidden_size1</span><span class=o>=</span><span class=mi>64</span><span class=p>,</span> <span class=n>hidden_size2</span><span class=o>=</span><span class=mi>32</span><span class=p>,</span> <span class=n>output_size</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
</span><span id=__span-8-105><a id=__codelineno-8-105 name=__codelineno-8-105 href=#__codelineno-8-105></a><span class=n>losses</span> <span class=o>=</span> <span class=n>mlp</span><span class=o>.</span><span class=n>train</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>500</span><span class=p>)</span>
</span><span id=__span-8-106><a id=__codelineno-8-106 name=__codelineno-8-106 href=#__codelineno-8-106></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>mlp</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span><span id=__span-8-107><a id=__codelineno-8-107 name=__codelineno-8-107 href=#__codelineno-8-107></a><span class=n>y_test_labels</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-8-108><a id=__codelineno-8-108 name=__codelineno-8-108 href=#__codelineno-8-108></a><span class=n>accuracy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>y_pred</span> <span class=o>==</span> <span class=n>y_test_labels</span><span class=p>)</span>
</span><span id=__span-8-109><a id=__codelineno-8-109 name=__codelineno-8-109 href=#__codelineno-8-109></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Test Accuracy: </span><span class=si>{</span><span class=n>accuracy</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-8-110><a id=__codelineno-8-110 name=__codelineno-8-110 href=#__codelineno-8-110></a>
</span><span id=__span-8-111><a id=__codelineno-8-111 name=__codelineno-8-111 href=#__codelineno-8-111></a><span class=c1># Visualizations</span>
</span><span id=__span-8-112><a id=__codelineno-8-112 name=__codelineno-8-112 href=#__codelineno-8-112></a><span class=n>pca</span> <span class=o>=</span> <span class=n>PCA</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-8-113><a id=__codelineno-8-113 name=__codelineno-8-113 href=#__codelineno-8-113></a><span class=n>X_test_2d</span> <span class=o>=</span> <span class=n>pca</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span><span id=__span-8-114><a id=__codelineno-8-114 name=__codelineno-8-114 href=#__codelineno-8-114></a><span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>X_test_2d</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>X_test_2d</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>c</span><span class=o>=</span><span class=n>y_pred</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s1>'viridis'</span><span class=p>,</span> <span class=n>edgecolors</span><span class=o>=</span><span class=s1>'k'</span><span class=p>)</span>
</span><span id=__span-8-115><a id=__codelineno-8-115 name=__codelineno-8-115 href=#__codelineno-8-115></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Test Data (PCA) with Predicted Labels'</span><span class=p>)</span>
</span><span id=__span-8-116><a id=__codelineno-8-116 name=__codelineno-8-116 href=#__codelineno-8-116></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'PCA Component 1'</span><span class=p>)</span>
</span><span id=__span-8-117><a id=__codelineno-8-117 name=__codelineno-8-117 href=#__codelineno-8-117></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'PCA Component 2'</span><span class=p>)</span>
</span><span id=__span-8-118><a id=__codelineno-8-118 name=__codelineno-8-118 href=#__codelineno-8-118></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-8-119><a id=__codelineno-8-119 name=__codelineno-8-119 href=#__codelineno-8-119></a>
</span><span id=__span-8-120><a id=__codelineno-8-120 name=__codelineno-8-120 href=#__codelineno-8-120></a><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>losses</span><span class=p>)</span>
</span><span id=__span-8-121><a id=__codelineno-8-121 name=__codelineno-8-121 href=#__codelineno-8-121></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>'Training Loss Over Epochs'</span><span class=p>)</span>
</span><span id=__span-8-122><a id=__codelineno-8-122 name=__codelineno-8-122 href=#__codelineno-8-122></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Epoch'</span><span class=p>)</span>
</span><span id=__span-8-123><a id=__codelineno-8-123 name=__codelineno-8-123 href=#__codelineno-8-123></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Loss'</span><span class=p>)</span>
</span><span id=__span-8-124><a id=__codelineno-8-124 name=__codelineno-8-124 href=#__codelineno-8-124></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <h3 id=explanation-of-changes-from-exercise-3><strong>Explanation of Changes from Exercise 3</strong></h3> <ul> <li><strong>Architecture</strong>: Added a second hidden layer with 8 neurons (ReLU). Updated weights (<code>W2</code>, <code>W3</code>) and biases (<code>b2</code>, <code>b3</code>) accordingly.</li> <li><strong>Forward Pass</strong>: Added computation for the second hidden layer (<code>z2</code>, <code>h2</code>) before the output layer.</li> <li><strong>Backward Pass</strong>: Extended backpropagation to include gradients for the second hidden layer (<code>dL_dz2</code>, <code>dL_dW2</code>, <code>dL_db2</code>).</li> <li><strong>Data and Evaluation</strong>: Identical to Exercise 3, reusing the same dataset and PCA visualization.</li> <li><strong>Reuse</strong>: The core methods (<code>relu</code>, <code>softmax</code>, <code>compute_loss</code>, <code>train</code>, <code>predict</code>) are unchanged in logic, only extended to handle the additional layer.</li> </ul> <h3 id=sample-output_1><strong>Sample Output</strong></h3> <p></p><div class="language-text highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>Epoch 0, Loss: 1.9552
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>Epoch 50, Loss: 0.6252
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>Epoch 100, Loss: 0.5576
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>Epoch 150, Loss: 0.5183
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>Epoch 200, Loss: 0.4882
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>Epoch 250, Loss: 0.4652
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>Epoch 300, Loss: 0.4461
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>Epoch 350, Loss: 0.4306
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>Epoch 400, Loss: 0.4287
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>Epoch 450, Loss: 0.4198
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>Test Accuracy: 0.7267
</span></code></pre></div> - The loss decreases, similar to Exercise 3, but the deeper architecture may improve separation for complex data. - Accuracy around 72% indicates strong performance, slightly better than Exercise 3 due to increased model capacity. - The PCA scatter plot and loss plot are similar to Exercise 3, confirming the model’s ability to classify the data.<p></p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../ex4-1.png data-desc-position=bottom><img alt="Decision Boundary Plot" src=../ex4-1.png></a> <a class=glightbox data-type=image data-width=auto data-height=auto href=../ex4-2.png data-desc-position=bottom><img alt="Training Loss Plot" src=../ex4-2.png></a></p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="September 28, 2025 14:04:54 UTC">September 28, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="September 28, 2025 14:01:50 UTC">September 28, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"></path></svg> </span> <nav> <a href=mailto:matheusaguiar362@gmail.com>c0d8</a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking", "navigation.expand"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.92b07e13.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src=https://unpkg.com/mathjax/es5/tex-mml-chtml.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://fastly.jsdelivr.net/npm/jquery/dist/jquery.min.js></script> <script src=https://fastly.jsdelivr.net/npm/echarts/dist/echarts.min.js></script> <script src=../../assets/javascripts/badge.js async></script> <script src=../../termynal.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>